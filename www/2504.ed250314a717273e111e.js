(self.webpackChunkdrink_counter=self.webpackChunkdrink_counter||[]).push([[2504],{2504:(e,n,t)=>{"use strict";t.r(n),t.d(n,{Tab1PageModule:()=>B});var i=t(9728),o=t(8583),r=t(665),l=t(3686),a=t(4762),c=t(7238),d=t(8720),s=t(6628);let u=(()=>{class e{constructor(){this.CURRENT_DRINK_LIST_KEY="current_drink_list"}saveCurrentBill(e){s.K.set({key:this.CURRENT_DRINK_LIST_KEY,value:JSON.stringify(e)})}getCurrentBill(){return(0,a.mG)(this,void 0,void 0,function*(){let e=yield s.K.get({key:this.CURRENT_DRINK_LIST_KEY});return JSON.parse(e.value)})}deleteCurrentBill(){return(0,a.mG)(this,void 0,void 0,function*(){return yield s.K.remove({key:this.CURRENT_DRINK_LIST_KEY})})}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275prov=d.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var p=t(1696);function g(e,n){if(1&e&&(d.TgZ(0,"ion-card-subtitle"),d._uU(1),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.hij("",e.drinkCard.price,"\u20ac")}}function f(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"ion-content"),d.TgZ(1,"ion-list"),d.TgZ(2,"ion-item",10),d.NdJ("click",function(){return d.CHM(e),d.oxw().editCard()}),d.TgZ(3,"ion-label"),d._uU(4,"Editar"),d.qZA(),d._UZ(5,"ion-icon",11),d.qZA(),d.TgZ(6,"ion-item",10),d.NdJ("click",function(){return d.CHM(e),d.oxw().deleteCard()}),d.TgZ(7,"ion-label",12),d._uU(8,"Eliminar"),d.qZA(),d._UZ(9,"ion-icon",13),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(2),d.Q6J("button",!0)("detail",!1),d.xp6(4),d.Q6J("button",!0)("detail",!1))}let h=(()=>{class e{constructor(){this.deleteCardEvent=new d.vpe,this.editCardEvent=new d.vpe,this.onChange=new d.vpe}ngOnInit(){}addDrink(){this.drinkCard.count++,this.onChange.emit()}removeDrink(){this.drinkCard.count>0&&(this.drinkCard.count--,this.onChange.emit())}deleteCard(){this.deleteCardEvent.emit(this.index)}editCard(){this.editCardEvent.emit(this.index)}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=d.Xpm({type:e,selectors:[["drink-counter-card"]],inputs:{drinkCard:"drinkCard",index:"index"},outputs:{deleteCardEvent:"deleteCardEvent",editCardEvent:"editCardEvent",onChange:"onChange"},decls:16,vars:7,consts:[[4,"ngIf"],["shape","round","fill","clear",1,"open-popover-button",3,"id"],["name","ellipsis-vertical"],[1,"ion-text-justify"],["shape","round","fill","outline",1,"remove-button",3,"click"],["name","remove-outline"],[1,"drink-count"],["shape","round","fill","outline",1,"add-button",3,"click"],["name","add-outline"],[3,"trigger","dismissOnSelect","arrow"],[3,"button","detail","click"],["name","pencil"],["color","danger"],["color","danger","name","trash"]],template:function(e,n){1&e&&(d.TgZ(0,"ion-card"),d.TgZ(1,"ion-card-header"),d.TgZ(2,"ion-card-title"),d._uU(3),d.qZA(),d.YNc(4,g,2,1,"ion-card-subtitle",0),d.TgZ(5,"ion-button",1),d._UZ(6,"ion-icon",2),d.qZA(),d.qZA(),d.TgZ(7,"ion-card-content",3),d.TgZ(8,"ion-button",4),d.NdJ("click",function(){return n.removeDrink()}),d._UZ(9,"ion-icon",5),d.qZA(),d.TgZ(10,"p",6),d._uU(11),d.qZA(),d.TgZ(12,"ion-button",7),d.NdJ("click",function(){return n.addDrink()}),d._UZ(13,"ion-icon",8),d.qZA(),d.qZA(),d.qZA(),d.TgZ(14,"ion-popover",9),d.YNc(15,f,10,4,"ng-template"),d.qZA()),2&e&&(d.xp6(3),d.Oqu(n.drinkCard.name),d.xp6(1),d.Q6J("ngIf",n.drinkCard.price),d.xp6(1),d.s9C("id","open-popover-button"+n.index),d.xp6(6),d.Oqu(n.drinkCard.count),d.xp6(3),d.s9C("trigger","open-popover-button"+n.index),d.Q6J("dismissOnSelect",!0)("arrow",!0))},directives:[i.PM,i.Zi,i.Dq,o.O5,i.YG,i.gu,i.FN,i.d8,i.tO,i.W2,i.q_,i.Ie,i.Q$],styles:["ion-card-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.add-button[_ngcontent-%COMP%]{float:right}.drink-count[_ngcontent-%COMP%]{font-size:26px}.remove-button[_ngcontent-%COMP%]{float:left}.open-popover-button[_ngcontent-%COMP%]{position:absolute;right:0;top:5px}"]}),e})();const C=["placeNameInput"];function b(e,n){1&e&&(d.TgZ(0,"ion-title",13),d._uU(1," Contador "),d.qZA())}function m(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"ion-title",14),d.NdJ("click",function(){return d.CHM(e),d.oxw().editBarName(!0)}),d._uU(1),d.qZA()}if(2&e){const e=d.oxw();d.xp6(1),d.hij(" ",null==e.bill?null:e.bill.placeName," ")}}function Z(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"ion-input",15,16),d.NdJ("ngModelChange",function(n){return d.CHM(e),d.oxw().bill.placeName=n})("ionBlur",function(){return d.CHM(e),d.oxw().editBarName(!1)})("keyup.enter",function(){return d.CHM(e),d.oxw().editBarName(!1)})("ionFocus",function(n){return d.CHM(e),d.oxw().ionInputSelectAll(n)}),d.qZA()}if(2&e){const e=d.oxw();d.Q6J("ngModel",e.bill.placeName)}}function v(e,n){1&e&&d._UZ(0,"ion-icon",17)}function k(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"div",18),d.TgZ(1,"h1"),d._uU(2,"Empieza una nueva cuenta"),d.qZA(),d.TgZ(3,"ion-button",19),d.NdJ("click",function(){return d.CHM(e),d.oxw().startNewBill()}),d._uU(4," A\xf1adir bebida "),d.qZA(),d.qZA()}}function x(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"drink-counter-card",22),d.NdJ("onChange",function(){return d.CHM(e),d.oxw(2).saveDrinkList()})("deleteCardEvent",function(n){return d.CHM(e),d.oxw(2).deleteCard(n)})("editCardEvent",function(n){return d.CHM(e),d.oxw(2).editCard(n)}),d.qZA()}if(2&e){const e=n.index;d.Q6J("drinkCard",n.$implicit)("index",e)}}function T(e,n){if(1&e&&(d.TgZ(0,"div",20),d.YNc(1,x,1,2,"drink-counter-card",21),d.qZA()),2&e){const e=d.oxw();d.xp6(1),d.Q6J("ngForOf",e.bill.drinkCardList)}}function N(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"ion-fab",23),d.TgZ(1,"ion-fab-button",24),d.NdJ("click",function(){return d.CHM(e),d.oxw().addDrinkCard()}),d._UZ(2,"ion-icon",25),d.qZA(),d.qZA()}}function A(e,n){if(1&e&&(d.TgZ(0,"ion-footer",26),d.TgZ(1,"ion-toolbar",27),d.TgZ(2,"ion-label",28),d._uU(3,"Total"),d.qZA(),d.TgZ(4,"ion-note",29),d._uU(5),d.ALo(6,"number"),d.qZA(),d.qZA(),d.qZA()),2&e){const e=d.oxw();d.Q6J("@totalPriceFooter",void 0),d.xp6(5),d.hij("",d.xi3(6,2,e.getTotalPrice(),"0.0-2"),"\u20ac")}}function _(e,n){if(1&e){const e=d.EpF();d.TgZ(0,"ion-content"),d.TgZ(1,"ion-list"),d.TgZ(2,"ion-item",30),d.NdJ("click",function(){return d.CHM(e),d.oxw().showSaveBillConfirmationAlert()}),d.TgZ(3,"ion-label"),d._uU(4,"Finalizar cuenta"),d.qZA(),d._UZ(5,"ion-icon",31),d.qZA(),d.TgZ(6,"ion-item",30),d.NdJ("click",function(){return d.CHM(e),d.oxw().showDeleteBillConfirmationAlert()}),d.TgZ(7,"ion-label",32),d._uU(8,"Borrar cuenta"),d.qZA(),d._UZ(9,"ion-icon",33),d.qZA(),d.qZA(),d.qZA()}2&e&&(d.xp6(2),d.Q6J("button",!0)("detail",!1),d.xp6(4),d.Q6J("button",!0)("detail",!1))}const q=[{path:"",component:(()=>{class e{constructor(e,n,t){this.drinkSessionService=e,this.drinkHistoryService=n,this.alertCtrl=t,this.editPlaceNameMode=!1}ngOnInit(){this.drinkSessionService.getCurrentBill().then(e=>{e&&(this.bill=e)},e=>{console.log(e)})}startNewBill(){this.bill={placeName:"Bar 1",startDate:(new Date).getTime(),drinkCardList:[]},this.addDrinkCard()}saveDrinkList(){this.drinkSessionService.saveCurrentBill(this.bill)}addDrinkCard(){this.bill.drinkCardList.push({name:"Bebida",count:0})}deleteCard(e){e>=0&&(this.bill.drinkCardList.splice(e,1),this.drinkSessionService.saveCurrentBill(this.bill))}editCard(e){return(0,a.mG)(this,void 0,void 0,function*(){e>=0&&(yield this.alertCtrl.create({header:"Editar tarjeta",inputs:[{name:"name",type:"text",value:this.bill.drinkCardList[e].name,placeholder:"Nombre de la bebida",label:"Nombre"},{name:"price",type:"number",value:this.bill.drinkCardList[e].price,placeholder:"Precio",label:"Precio"}],buttons:[{text:"Cancelar"},{text:"Aceptar",handler:n=>{this.bill.drinkCardList[e]=Object.assign(Object.assign({},this.bill.drinkCardList[e]),n)}}]})).present()})}editBarName(e){(this.bill.placeName.length||e)&&(this.editPlaceNameMode=e,e?setTimeout(()=>{this.placeNameInput.setFocus()},50):this.drinkSessionService.saveCurrentBill(this.bill))}ionInputSelectAll(e){e.target.select?e.target.select():e.target.children[0].select&&e.target.children[0].select()}showSaveBillConfirmationAlert(){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.alertCtrl.create({header:"Finalizar cuenta",message:"\xbfFinalizar cuenta y guardarla?",buttons:[{text:"Cancelar"},{text:"Aceptar",handler:()=>{this.saveBill()}}]})).present()})}saveBill(){this.bill.endDate=(new Date).getTime(),this.drinkHistoryService.addBillToDrinkHistory(this.bill),this.drinkSessionService.deleteCurrentBill(),this.bill=void 0}showDeleteBillConfirmationAlert(){return(0,a.mG)(this,void 0,void 0,function*(){(yield this.alertCtrl.create({header:"Borrar cuenta",message:"\xbfSeguro que quieres borrar la cuenta?",buttons:[{text:"Cancelar"},{text:"Aceptar",handler:()=>{this.deleteBill()}}]})).present()})}deleteBill(){this.bill=void 0,this.drinkSessionService.deleteCurrentBill()}getTotalPrice(){var e;if(null===(e=this.bill)||void 0===e?void 0:e.drinkCardList)return this.bill.drinkCardList.reduce((e,n)=>e+(n.price||0)*n.count,0)}}return e.\u0275fac=function(n){return new(n||e)(d.Y36(u),d.Y36(p.F),d.Y36(i.Br))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-tab1"]],viewQuery:function(e,n){if(1&e&&d.Gf(C,5),2&e){let e;d.iGM(e=d.CRH())&&(n.placeNameInput=e.first)}},decls:18,vars:13,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large",4,"ngIf"],["size","large",3,"click",4,"ngIf"],["class","place-name-input ion-padding","autocapitalize","sentences","autofocus","true","placeholder","Nombre del bar","type","text","size","50",3,"ngModel","ngModelChange","ionBlur","keyup.enter","ionFocus",4,"ngIf"],["id","open-bill-popover-button","slot","end","shape","round","fill","clear","color","dark",1,"close-account-button"],["slot","icon-only","name","ellipsis-vertical",4,"ngIf"],["class","button-container",4,"ngIf"],["class","drink-card-container",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed",4,"ngIf"],["class","ion-no-border",4,"ngIf"],["trigger","open-bill-popover-button",3,"dismissOnSelect","arrow"],["size","large"],["size","large",3,"click"],["autocapitalize","sentences","autofocus","true","placeholder","Nombre del bar","type","text","size","50",1,"place-name-input","ion-padding",3,"ngModel","ngModelChange","ionBlur","keyup.enter","ionFocus"],["placeNameInput",""],["slot","icon-only","name","ellipsis-vertical"],[1,"button-container"],["shape","round",3,"click"],[1,"drink-card-container"],[3,"drinkCard","index","onChange","deleteCardEvent","editCardEvent",4,"ngFor","ngForOf"],[3,"drinkCard","index","onChange","deleteCardEvent","editCardEvent"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"click"],["name","add"],[1,"ion-no-border"],[1,"ion-padding-horizontal"],[1,"footer-label"],["color","dark","slot","end",1,"footer-value"],[3,"button","detail","click"],["name","checkmark-done"],["color","danger"],["color","danger","name","trash"]],template:function(e,n){1&e&&(d.TgZ(0,"ion-header",0),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3),d.qZA(),d.qZA(),d.qZA(),d.TgZ(4,"ion-content",1),d.TgZ(5,"ion-header",2),d.TgZ(6,"ion-toolbar"),d.YNc(7,b,2,0,"ion-title",3),d.YNc(8,m,2,1,"ion-title",4),d.YNc(9,Z,2,1,"ion-input",5),d.TgZ(10,"ion-button",6),d.YNc(11,v,1,0,"ion-icon",7),d.qZA(),d.qZA(),d.qZA(),d.YNc(12,k,5,0,"div",8),d.YNc(13,T,2,1,"div",9),d.YNc(14,N,3,0,"ion-fab",10),d.qZA(),d.YNc(15,A,7,5,"ion-footer",11),d.TgZ(16,"ion-popover",12),d.YNc(17,_,10,4,"ng-template"),d.qZA()),2&e&&(d.Q6J("translucent",!0),d.xp6(3),d.hij(" ",(null==n.bill?null:n.bill.placeName)||"Contador"," "),d.xp6(1),d.Q6J("fullscreen",!0),d.xp6(3),d.Q6J("ngIf",!n.bill),d.xp6(1),d.Q6J("ngIf",!n.editPlaceNameMode),d.xp6(1),d.Q6J("ngIf",n.bill&&n.editPlaceNameMode),d.xp6(2),d.Q6J("ngIf",n.bill),d.xp6(1),d.Q6J("ngIf",!n.bill),d.xp6(1),d.Q6J("ngIf",n.bill),d.xp6(1),d.Q6J("ngIf",n.bill),d.xp6(1),d.Q6J("ngIf",n.getTotalPrice()),d.xp6(1),d.Q6J("dismissOnSelect",!0)("arrow",!0))},directives:[i.Gu,i.sr,i.wd,i.W2,o.O5,i.YG,i.d8,i.pK,i.j9,r.JJ,r.On,i.gu,o.sg,h,i.IJ,i.W4,i.fr,i.Q$,i.uN,i.q_,i.Ie],pipes:[o.JJ],styles:[".button-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:center;align-content:center;justify-content:space-around}.close-account-button[_ngcontent-%COMP%]{padding-top:10px}.drink-card-container[_ngcontent-%COMP%]{padding-bottom:60px}.place-name-input[_ngcontent-%COMP%]{font-size:34px;font-weight:700;border-bottom:1px solid var(--ion-color-dark-tint)}.footer-label[_ngcontent-%COMP%]{font-weight:700}.footer-value[_ngcontent-%COMP%]{font-size:24px;opacity:65%}"],data:{animation:[(0,c.X$)("totalPriceFooter",[(0,c.eR)(":enter",[(0,c.oB)({transform:"translateY(100%)"}),(0,c.jt)(100)]),(0,c.eR)(":leave",[(0,c.jt)(100,(0,c.oB)({transform:"translateY(100%)"}))])])]}}),e})()}];let w=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[l.Bz.forChild(q)],l.Bz]}),e})(),J=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[o.ez,r.u5,i.Pc]]}),e})(),B=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[i.Pc,o.ez,r.u5,J,w]]}),e})()}}]);